{"version":3,"file":"sandbox.iife.min.js","sources":["../src/lib/util.js","../src/lib/attrs.js","../src/lib/node.js","../src/lib/props.js","../src/lib/events.js","../src/index.js","../tests/e2e/main.test.js"],"sourcesContent":["export const isArray = value => Array.isArray(value);\nexport const isFunction = value => typeof value === 'function';\nexport const isUndef = value => typeof value === 'undefined' || value === null;\nexport const isObject = value => value !== null && (typeof value === 'function' || typeof value === 'object');\nexport const isScalar = value => typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean';\n\nexport const isDiff = (prev, next) => {\n  if (isFunction(prev) || isFunction(next) || typeof prev !== typeof next) return true;\n  if (isArray(prev)) {\n    if (prev.length !== next.length) return true;\n    if (prev.some(x => next.indexOf(x) === -1)) return true;\n  } else if (isObject(prev)) {\n    const a = Object.keys(prev).sort();\n    const b = Object.keys(next).sort();\n\n    if (isDiff(a, b)) return true;\n\n    for (let i = 0; i < a.length; i += 1) {\n      if (isDiff(prev[a[i]], next[b[i]])) return true;\n    }\n  } else return prev !== next;\n};\n\nexport const isEmpty = value => {\n  if (isFunction(value)) return false;\n  if (isArray(value)) return value.length === 0;\n  if (isObject(value)) return Object.keys(value).length === 0;\n\n  return typeof value === 'undefined' || value === '' || value === null || value === false;\n};\n\nexport const isNode = x => isArray(x) && x.length <= 3 && (typeof x[0] === 'string' || typeof x[0] === 'function') && !isEmpty(x[0]);\n\nexport const dashCase = value => value.replace(/[A-Z]/g, '-$&').toLowerCase();\nexport const toArray = value => (!isEmpty(value) && !isArray(value) ? [value] : value) || [];\nexport const filter = (value, cb) => value.filter(cb || (x => !isEmpty(x)));\n\nexport const format = value => {\n  const xml = String(value)\n    .replace(/^\\s+|\\s+$/g, '')\n    .replace(/></g, '>\\n<')\n    .replace(/\\/(\\w+)></g, '/$1>\\n<')\n    .replace(/>(.+?)<([a-zA-Z])/g, '>\\n$1\\n<$2');\n\n  const output = xml.split('\\n');\n\n  for (let i = 0, tabs = ''; i < output.length; i += 1) {\n    const line = output[i].replace(/^\\s+|\\s+$/g, '');\n\n    if (/^<[/]/.test(line)) {\n      tabs = tabs.replace('  ', '');\n      output[i] = tabs + line;\n    } else if (/<.*>.*<\\/.*>|<.*[^>]\\/>/.test(line)) {\n      output[i] = tabs + line;\n    } else {\n      output[i] = tabs + line;\n      tabs += '  ';\n    }\n  }\n\n  return output.join('\\n');\n};\n\nexport const trim = value => {\n  const matches = value.match(/\\n( )*/);\n  const spaces = matches[0].substr(0, matches[0].length - 1);\n  const depth = spaces.split('').length;\n\n  return value.replace(new RegExp(`^ {${depth}}`, 'mg'), '').trim();\n};\n\nexport const zipMap = (a, b, cb) => Array.from({ length: Math.max(a.length, b.length) }).map((_, i) => cb(a[i], b[i], i));\nexport const apply = (cb, length, options = {}) => (...args) => length === args.length && cb(...args, options);\nexport const raf = cb => ((typeof window !== 'undefined' && window.requestAnimationFrame) || setTimeout)(cb);\n\nexport const replace = (target, node, i) => target.replaceChild(node, target.childNodes[i]);\nexport const remove = (target, node) => target && target.removeChild(node);\nexport const append = (target, node) => target.appendChild(node);\nexport const detach = target => remove(target.parentNode, target);\n","import {\n  isEmpty, isObject, isFunction, isScalar, isDiff, isArray, toArray,\n} from './util';\n\nexport const XLINK_NS = 'http://www.w3.org/1999/xlink';\nexport const ELEM_REGEX = /(\\w*)(#\\w+)?([\\w.]+)?/;\n\nexport function fixProps(vnode) {\n  if (isArray(vnode[1]) || isScalar(vnode[1])) {\n    vnode[2] = vnode[1];\n    vnode[1] = null;\n  }\n\n  let attrs = vnode[1] || null;\n  let name = vnode[0];\n\n  if (typeof name === 'string') {\n    const matches = name.match(ELEM_REGEX);\n\n    attrs = { ...attrs };\n    name = matches[1] || ((matches[2] || matches[3]) ? 'div' : null);\n\n    if (matches[2]) {\n      attrs.id = matches[2].substr(1);\n    }\n\n    if (matches[3]) {\n      const classes = matches[3].substr(1).split('.');\n\n      if (isObject(attrs.class)) {\n        classes.forEach(x => { attrs.class[x] = 1; });\n      } else if (isArray(attrs.class) || isScalar(attrs.class)) {\n        attrs.class = !isArray(attrs.class) ? attrs.class.split(' ') : attrs.class;\n        attrs.class = classes.concat(attrs.class).reduce((prev, cur) => {\n          if (prev.indexOf(cur) === -1) prev.push(cur);\n          return prev;\n        }, []);\n      } else {\n        attrs.class = classes;\n      }\n    }\n  }\n\n  return [name, attrs, toArray(vnode[2])];\n}\n\nexport function assignProps(target, attrs, svg, cb) {\n  Object.keys(attrs).forEach(prop => {\n    if (prop === 'key' || isObject(attrs[prop])) {\n      attrs[prop] = (isFunction(cb) && cb(target, prop, attrs[prop])) || null;\n\n      if (prop === 'key') return;\n    }\n\n    const removed = isEmpty(attrs[prop]);\n    const value = attrs[prop] === true ? prop : attrs[prop];\n    const name = prop.replace(/^xlink:?/, '');\n\n    if (svg && prop !== name) {\n      if (removed) target.removeAttributeNS(XLINK_NS, name);\n      else target.setAttributeNS(XLINK_NS, name, value);\n      return;\n    }\n\n    if (removed) target.removeAttribute(prop);\n    else target.setAttribute(prop, value);\n  });\n}\n\nexport function updateProps(target, prev, next, svg, cb) {\n  let changed;\n\n  const keys = Object.keys(prev).concat(Object.keys(next));\n  const props = keys.reduce((all, k) => {\n    if (k in prev && !(k in next)) {\n      all[k] = null;\n      changed = true;\n    } else if (isDiff(prev[k], next[k])) {\n      all[k] = next[k];\n      changed = true;\n    }\n\n    return all;\n  }, {});\n\n  if (changed) assignProps(target, props, svg, cb);\n\n  return changed;\n}\n","import {\n  isFunction, isScalar, isNode, isEmpty, isUndef, isDiff, append, replace, detach, zipMap,\n} from './util';\n\nimport { assignProps, updateProps, fixProps } from './attrs';\n\nexport const SVG_NS = 'http://www.w3.org/2000/svg';\n\nexport function destroyElement(target, wait = cb => cb()) {\n  return Promise.resolve().then(() => wait(() => target.remove()));\n}\n\nexport function createElement(value, svg, cb) {\n  if (isScalar(value)) return document.createTextNode(value);\n  if (isUndef(value)) throw new TypeError(`Empty or invalid node, given '${value}'`);\n  if (!isNode(value)) return;\n\n  const [tag, attrs, children] = fixProps([...value]);\n  const isSvg = svg || tag === 'svg';\n\n  let el;\n\n  if (typeof tag === 'string') {\n    el = isSvg ? document.createElementNS(SVG_NS, tag) : document.createElement(tag);\n  }\n\n  if (isFunction(cb)) {\n    el = cb(el, tag, attrs, children) || el;\n  }\n\n  if (isFunction(el)) return createElement(el(), isSvg, cb);\n\n  if (!el && isFunction(tag)) {\n    el = tag(attrs, children);\n\n    if (isScalar(el) || isNode(el)) {\n      el = createElement(el, svg, cb);\n    }\n\n    return el;\n  }\n\n  if (!isEmpty(attrs)) assignProps(el, attrs, isSvg, cb);\n  if (isFunction(el.oncreate)) el.oncreate(el);\n  if (isFunction(el.enter)) el.enter();\n\n  el.remove = () => Promise.resolve()\n    .then(() => isFunction(el.ondestroy) && el.ondestroy(el))\n    .then(() => isFunction(el.teardown) && el.teardown())\n    .then(() => isFunction(el.exit) && el.exit())\n    .then(() => detach(el));\n\n  children.forEach(vnode => {\n    if (!isEmpty(vnode)) el.appendChild(createElement(vnode, isSvg, cb));\n  });\n\n  return el;\n}\n\nexport function mountElement(target, view, cb = createElement) {\n  if (typeof view === 'function') {\n    cb = view;\n    view = target;\n    target = undefined;\n  }\n\n  if (!view) {\n    view = target;\n    target = undefined;\n  }\n\n  if (!target) {\n    target = document.body;\n  }\n\n  if (typeof target === 'string') {\n    target = document.querySelector(target);\n  }\n\n  const el = isScalar(view) || isNode(view) ? cb(view) : view;\n\n  append(target, el);\n\n  return el;\n}\n\nexport function updateElement(target, prev, next, svg, cb, i = 0) {\n  if (i === null) {\n    const a = fixProps([...prev]);\n    const b = fixProps([...next]);\n\n    if (updateProps(target, a[1], b[1], svg, cb)) {\n      if (isFunction(target.onupdate)) target.onupdate(target);\n      if (isFunction(target.update)) target.update();\n    }\n\n    zipMap(a[2], b[2], (x, y, z) => updateElement(target, x, y, svg, cb, z));\n  } else if (isScalar(prev) && isScalar(next)) {\n    if (isDiff(prev, next)) {\n      target.childNodes[i].nodeValue = next;\n    }\n  } else if (!prev && next) append(target, createElement(next, svg, cb));\n  else if (prev && !next) destroyElement(target.childNodes[i]);\n  else if (prev[0] !== next[0]) {\n    if (isNode(prev) && isNode(next)) replace(target, createElement(next, svg, cb), i);\n    else zipMap(prev, next, (x, y, z) => updateElement(target, x, y, svg, cb, z));\n  } else updateElement(target.childNodes[i], prev, next, svg, cb, null);\n}\n\nexport function createView(tag, state, actions) {\n  return (el, cb = createElement) => {\n    const data = { ...state };\n\n    let childNode;\n    let vnode;\n\n    const $ = Object.keys(actions)\n      .reduce((prev, cur) => {\n        prev[cur] = (...args) => Promise.resolve()\n          .then(() => actions[cur](...args)(data))\n          .then(result => Object.assign(data, result))\n          .then(newData => {\n            updateElement(childNode, vnode, vnode = tag(newData, $), null, cb, null);\n          });\n\n        return prev;\n      }, {});\n\n    childNode = mountElement(el, vnode = tag(data, $), cb);\n\n    $.unmount = () => destroyElement(childNode);\n    $.target = childNode;\n\n    return $;\n  };\n}\n","import {\n  dashCase, isFunction, isObject, isScalar, isArray, isUndef, filter, raf,\n} from './util';\n\nexport function values(attrs, cb) {\n  if (isUndef(attrs)) return [];\n  if (!isObject(attrs)) return attrs;\n  if (isArray(attrs)) return filter(attrs);\n\n  return filter(Object.keys(attrs).reduce((prev, cur) => {\n    if (!isUndef(attrs[cur])) prev.push(cb(attrs[cur], cur));\n\n    return prev;\n  }, []));\n}\n\nexport function styles(props) {\n  return values(props, (v, k) => `${dashCase(k)}: ${v}`, '; ');\n}\n\nexport function classes(props) {\n  return values(props, (v, k) => (v ? k : undefined));\n}\n\nexport function datasets(el, name, props) {\n  if (isArray(props)) {\n    el.setAttribute(`data-${name}`, JSON.stringify(props));\n  } else {\n    Object.keys(props).forEach(key => {\n      const value = !isScalar(props[key])\n        ? JSON.stringify(props[key])\n        : props[key];\n\n      el.setAttribute(`data-${name}-${key}`, value);\n    });\n  }\n}\n\nexport function nextProps(el, type, names) {\n  return () => new Promise(resolve => {\n    let t;\n\n    function onEnd() {\n      el.removeEventListener('animationend', onEnd);\n\n      names.map(x => el.classList.remove(x));\n\n      clearTimeout(t);\n      resolve();\n    }\n\n    t = setTimeout(onEnd, 500);\n\n    el.addEventListener('animationend', onEnd);\n\n    raf(() => { names.map(x => el.classList.add(x)); });\n  });\n}\n\nexport function invokeProps(el, name, value, helpers) {\n  if (isObject(helpers)) {\n    if (isFunction(helpers)) return helpers(value, name, el);\n    if (isFunction(helpers[name])) return helpers[name](value, name, el);\n  }\n\n  if (isObject(value)) datasets(el, name, value);\n}\n\nexport const applyStyles = value => styles(value).join('; ');\nexport const applyClasses = value => classes(value).join(' ');\nexport const applyAnimations = (value, name, el) => { el[name] = nextProps(el, name, classes(value)); };\n","import { isFunction, isObject } from './util';\n\nexport const EE_SUPPORTED = ['oncreate', 'onupdate', 'ondestroy'];\n\nexport function eventListener(e) {\n  return e.currentTarget.events[e.type](e);\n}\n\nexport function invokeEvent(e, name, value, globals) {\n  let skip;\n\n  if (isObject(globals)) {\n    if (isFunction(globals)) {\n      skip = globals(name, e) === false;\n    } else if (isFunction(globals[name])) {\n      skip = globals[name](e) === false;\n    }\n  }\n\n  if (!skip) value(e);\n}\n\nexport function addEvents(el, name, value, globals) {\n  if (isFunction(value)) {\n    el.events = el.events || {};\n\n    if (!el.teardown) {\n      el.teardown = () => Object.keys(el.events).map(x => el.removeEventListener(x, eventListener));\n    }\n\n    if (name.substr(0, 2) === 'on' && EE_SUPPORTED.indexOf(name) === -1) {\n      const type = name.substr(2);\n\n      if (!el.events[type]) el.addEventListener(type, eventListener, false);\n\n      el.events[type] = e => invokeEvent(e, name, value, globals);\n    } else {\n      (EE_SUPPORTED.indexOf(name) > -1 ? el : el.events)[name] = value;\n    }\n  }\n}\n","import {\n  createView as view,\n  mountElement as mount,\n  updateElement as patch,\n  createElement as render,\n  destroyElement as unmount,\n} from './lib/node';\n\nimport {\n  invokeProps,\n  applyStyles as styles,\n  applyClasses as classes,\n  applyAnimations as animation,\n} from './lib/props';\n\nimport {\n  apply, format, filter, isFunction,\n} from './lib/util';\n\nimport { addEvents } from './lib/events';\n\nexport const h = (name = 'div', attrs, ...children) => [name, attrs, children];\n\nexport const pre = (vnode, svg, cb = render) => {\n  return cb(['pre', { class: 'highlight' }, format(cb(vnode, svg).outerHTML)], svg);\n};\n\nexport const bind = (tag, ...hooks) => {\n  const cbs = filter(hooks, isFunction);\n\n  const mix = (...args) => {\n    return cbs.reduce((prev, cb) => cb(...args) || prev, undefined);\n  };\n\n  return (...args) => (args.length <= 2 ? tag(args[0], args[1], mix) : mix(...args));\n};\n\nexport const listeners = opts => apply(addEvents, 3, opts);\nexport const attributes = opts => apply(invokeProps, 3, opts);\n\nexport {\n  createView as view,\n  mountElement as mount,\n  updateElement as patch,\n  createElement as render,\n  destroyElement as unmount,\n} from './lib/node';\n\nexport {\n  applyStyles as styles,\n  applyClasses as classes,\n  applyAnimations as animation,\n} from './lib/props';\n\nexport default {\n  h,\n  pre,\n  bind,\n\n  view,\n  mount,\n  patch,\n  render,\n  unmount,\n\n  listeners,\n  attributes,\n\n  styles,\n  classes,\n  animation,\n};\n","import somedom, { mount, render } from '../../src';\nimport { trim as format } from '../../src/lib/util';\n\nfunction summarize(script) {\n  const { innerHTML, parentNode } = script;\n\n  const code = innerHTML\n    .replace(/( +)appendChild\\(([^;]*?)\\);?/gm, '$1$2')\n    .replace(/test\\(\\s*\\([^=()]*\\)\\s*=>\\s*\\{/, '')\n    .replace(/\\}\\)\\s*;$/, '');\n\n  mount(parentNode, ['details', [\n    ['summary', 'View executed code'],\n    ['pre', { class: 'highlight' }, format(code)],\n  ]]);\n}\n\nfunction appendChild(currentScript, newNode) {\n  const { loaded, parentNode } = currentScript;\n\n  if (!loaded) {\n    summarize(currentScript);\n\n    currentScript.loaded = true;\n  }\n\n  if (newNode) {\n    parentNode.insertBefore(newNode, currentScript);\n  }\n\n  return newNode;\n}\n\nconst tests = [];\n\nwindow.test = cb => {\n  tests.push({\n    cb,\n    el: document.currentScript,\n  });\n};\n\nwindow.addEventListener('DOMContentLoaded', () => {\n  tests.forEach(t => {\n    try {\n      t.cb(somedom, x => appendChild(t.el, x));\n    } catch (e) {\n      appendChild(t.el, render(['div.error', e.toString()]));\n    }\n  });\n\n  window.hijs = '.highlight';\n\n  mount('head', ['script', { src: '//cdn.rawgit.com/cloudhead/hijs/0eaa0031/hijs.js' }]);\n});\n"],"names":["const","isArray","value","Array","isFunction","isUndef","isObject","isScalar","isDiff","prev","next","length","some","x","indexOf","a","Object","keys","sort","b","let","i","isEmpty","isNode","dashCase","replace","toLowerCase","toArray","filter","cb","trim","matches","match","depth","substr","split","RegExp","zipMap","from","Math","max","map","_","apply","options","args","raf","window","requestAnimationFrame","setTimeout","target","node","replaceChild","childNodes","append","appendChild","detach","removeChild","remove","parentNode","ELEM_REGEX","fixProps","vnode","attrs","name","id","classes","class","forEach","concat","reduce","cur","push","assignProps","svg","prop","removed","removeAttributeNS","XLINK_NS","setAttributeNS","removeAttribute","setAttribute","SVG_NS","destroyElement","wait","Promise","resolve","then","createElement","document","createTextNode","TypeError","el","isSvg","tag","createElementNS","children","oncreate","enter","ondestroy","teardown","exit","mountElement","view","undefined","body","querySelector","updateElement","changed","props","all","k","updateProps","onupdate","update","y","z","nodeValue","values","v","invokeProps","helpers","JSON","stringify","key","datasets","EE_SUPPORTED","eventListener","e","currentTarget","events","type","addEvents","globals","removeEventListener","addEventListener","skip","invokeEvent","render","output","String","tabs","line","test","join","format","outerHTML","cbs","hooks","mix","state","actions","childNode","data","$","result","assign","newData","unmount","mount","patch","opts","names","t","onEnd","classList","clearTimeout","add","nextProps","currentScript","newNode","loaded","script","code","innerHTML","summarize","insertBefore","tests","somedom","toString","hijs","src"],"mappings":"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"}